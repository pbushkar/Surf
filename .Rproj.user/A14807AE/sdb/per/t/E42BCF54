{
    "contents" : "library(tree);library(lattice);library(boot);library(MASS);library(fmsb);library(e1071);library(ipred);library(caret)\nlibrary('rpart');library(randomForest);library(mda)\nSurfboards <- read.csv(\"~/Data_mining/surf/.Rproj.user/SurfboardSoldAndOnHandAll.txt\", header=F)\nView(Surfboards)\nSurfboards <- Surfboards[,-3]\nSurfboards$V8 <- substring(Surfboards$V2,1,regexpr(\" \",as.character(Surfboards$V2))-1)\nView(Surfboards)\nSurfboards <- Surfboards[which(Surfboards$V8 != \"\"),]\n#Next time remove Catch Surf, McKevlins, and Hydroflex\n#Next time convert to inches and remove all greater than 79 inches\nSurfboards <- Surfboards[grep(\"10-\",Surfboards$V8,invert=TRUE),]\nSurfboards <- Surfboards[grep(\"9-\",Surfboards$V8,invert=TRUE),]\nSurfboards <- Surfboards[grep(\"8-\",Surfboards$V8,invert=TRUE),]\nSurfboards <- Surfboards[grep(\"7-\",Surfboards$V8,invert=TRUE),]\nSurfboards <- Surfboards[grep(\"6-10\",Surfboards$V8,invert=TRUE),]\nSurfboards <- Surfboards[grep(\"6-9\",Surfboards$V8,invert=TRUE),]\nSurfboards <- Surfboards[grep(\"00-00\",Surfboards$V8,invert=TRUE),]\nlevels(Surfboards$V2) <- c(levels(Surfboards$V2),\"6-2 Gullwing\")\nSurfboards[142,2] <- '6-2 Gullwing'\nSurfboards <- Surfboards[grep(\"Mckevlins\",Surfboards$V8,invert=TRUE),]\nSurfboards <- Surfboards[grep(\"unshape\",Surfboards$V2,invert=TRUE),]\nSurfboards <- Surfboards[grep(\"Catch Surf\",Surfboards$V1,invert=TRUE),]\nSurfboards <- Surfboards[grep(\"6-8 Mini\",Surfboards$V2,invert=TRUE),]\n#Remove all returns (V5 = R) and the previous sale of that board#\n#Populate Model, SellDate, ArriveDate, and SellDays fields\nSurfboards$Model <- substring(Surfboards$V2,regexpr(\" \",as.character(Surfboards$V2))+1)\nSurfboards$SellDate <- strptime(substring(Surfboards$V4,1,regexpr(\" \",as.character(Surfboards$V4))+1),\"%m/%d/%y\")\nSurfboards$ArriveDate <- strptime(substring(Surfboards$V6,1,regexpr(\" \",as.character(Surfboards$V6))+1),\"%m/%d/%y\")\nSurfboards$SellDays <- as.numeric(difftime(Surfboards$SellDate,Surfboards$ArriveDate,units=\"days\"))\n#Set V12 to sold within a year logical\nSurfboards[which(Surfboards$SellDays >= 365),12] <- FALSE\nSurfboards[which(Surfboards$SellDays < 365),12] <- TRUE\n#Build training, validation, and test sets\nDFS.NoNA <- DFS[!(is.na(DFS$SellYear)),]\nsamplingSubset <- sample(1:1183,1183,replace=F)\ntrainsub <- samplingSubset[1:887]\nvalidatesub <- samplingSubset[888:1035]\ntestsub <- samplingSubset[1036:1183]\nDFStrain <- DFS[trainsub,]\nDFSvalidate <- DFS[validatesub,]\nDFStest <- DFS[testsub,]\nDFStestVal <- DFS[- trainsub,]\nDFStrainVal <- DFS[-testsub,]\n#Define a log regression model using stepAIC and use LOOCV(its broken)\nlogm4 <- glm(formula = SellYear ~ LengthF + StyleCat + Brand + StyleCat * Brand+StyleCat*LengthF+Brand*LengthF, family = \"binomial\", data = DFS.NoNA, na.action = na.exclude)\nstepAIC(object = logm4, direction=\"backward\",steps=1000)$anova\nlogm5 <- glm(formula = SellYear ~ LengthF + StyleCat + Brand, family = \"binomial\", data = DFS.NoNA, na.action = na.exclude)\n\n#Define a tree for predictions\ntree1 <- tree(formula = as.factor(SellYear) ~ LengthF + StyleCat + Price + Brand, data = DFStrain)\nplot1 <- xyplot(SellDays~LengthF|Brand,data=DF,col=c(\"yellow\",\"purple\",\"green\",\"black\",\"red\",\"cyan\"),groups=StyleCat,pch=20,cex=1.25,main=\"Sell Days by Board Length\",xlab=\"Board Length in Inches\",ylab=\"Days Needed to Sell\",auto.key = list(group=DF$StyleCat,points = FALSE, x=.6,y=.7,corner = c(0,0),col=c(\"yellow\",\"purple\",\"green\",\"black\",\"red\",\"cyan\")),jitter.x=TRUE)\nplot2 <- xyplot(SellYear~LengthF|Brand,data=DF,col=c(\"yellow\",\"purple\",\"green\",\"black\",\"red\",\"cyan\"),groups=StyleCat,pch=20,cex=1,main=\"Success by Board Length (Near 1 Sold by a Year, 0 did not)\",xlab=\"Board Length in Inches\",ylab=\"Sold Within a Year (1 = Yes and 0 = No)\",auto.key = list(group=DF$StyleCat,points = FALSE, x=.6,y=.7,corner = c(0,0),col=c(\"yellow\",\"purple\",\"green\",\"black\",\"red\",\"cyan\")),jitter.y=TRUE)\nFirstMonthSellPlot <- histogram(~DF$SellDays|DF$StyleCat,data=DF,breaks=1253/30)\n",
    "created" : 1408214954994.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3735428205",
    "id" : "E42BCF54",
    "lastKnownWriteTime" : 1415857347,
    "path" : "~/Data_mining/surf/PrepareSurfData.R",
    "project_path" : "PrepareSurfData.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}